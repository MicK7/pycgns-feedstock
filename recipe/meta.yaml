{% set name = "pyCGNS" %}
{% set version = "6.3.0" %}

{% if numpy is not defined %}
{% set numpy = "2.0.0" %}
{% endif %}
{% set numpy_minor = numpy.split(".")[1] | int %}

package:
  name: {{ name|lower }}-glob
  version: {{ version }}

source:
  git_url: https://github.com/pyCGNS/pyCGNS.git
  git_rev: 98eb64c8551c21f9a06af063d72f15f6a24cd482
  #url: https://files.pythonhosted.org/packages/source/{{ name[0] }}/{{ name }}/{{ name|lower }}-{{ version }}.tar.gz
  #sha256: 7f64ba14ec5c8ee1cd7a328e805d7153f7c6513161fa00e9b115740d231200f3

build:
  number: 0
  skip: true  # [py<310]

outputs:
  - name: {{ name|lower }}-core
    version: {{ version }}
    script: build_core.sh  # [not win]
    script: bld_core.bat  # [win]

    requirements:
      build:
        - {{ compiler('c') }}
        - {{ stdlib("c") }}
        - hdf5

      host:
        - python
        - pip
        - python-build
        - meson-python
        - hdf5
        - numpy
        - cython
        - pkgconfig
        - git
        - git-lfs

      run:
        - python
        - hdf5
        - numpy

    test:
      imports:
        - CGNS.MAP
        - CGNS.PAT
        - CGNS.VAL

  - name: {{ name|lower }}
    version: {{ version }}
    script: build_all.sh  # [unix]
    script: bld_all.bat  # [win]

    requirements:
      build:
        - {{ compiler('c') }}
        - {{ stdlib("c") }}
        - hdf5

      host:
        - python
        - pip
        - python-build
        - meson-python
        - hdf5
        - numpy
        - cython
        - pkgconfig
        - qt-main
        - qtpy
        - pyside6
        - vtk
        - git
        - git-lfs

      run:
        - python
        - hdf5
        - numpy
        - qt-main
        - qtpy
        - pyside6
        - vtk

    test:
      imports:
        - CGNS.MAP
        - CGNS.PAT
        - CGNS.VAL

about:
  home: https://github.com/pyCGNS/pyCGNS
  license: LGPL-2.1-only
  license_file: LICENSE
  summary: pyCGNS provide a python interface to CGNS/SIDS datamodel for CGNS end-users and python application developpers
  doc_url: https://pycgns.github.io/
  dev_url: https://github.com/pyCGNS/pyCGNS

extra:
  recipe-maintainers:
    - MicK7
